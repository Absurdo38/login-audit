<tools>
    <tool id="sqlserver-login-audit" title="Login audit" projectTypes="inventory">
        <description>A DBMaster plugin that parses native sql server logs to get aggregated login statistics</description>

        <parameters>
            <parameter name="p_servers"   title="Servers"   type="string" required="false" multiple="true"
                       suggestion="project_connections" width="300" />
            <parameter name="p_resolve_hosts" title="Resolve hosts" type="boolean" required="true" defaultValue="false" />            

            <parameter name="p_storage_db"      title="Storage Database" type="string" required="false" 
                       suggestion="project_databases" width="300" />

            <parameter name="p_ldap_connection" title="LDAP Connection"    type="string" required="false"
                        width="300" />
            <parameter name="p_ldap_context"    title="LDAP Base Context"  type="string" required="false" 
            width="500" />
        </parameters>

        <output  script="sqlserver-login-audit.groovy" type="html" />
    </tool>
    
    <tool id="sqlserver-login-audit-tracking" title="Login audit tracking" projectTypes="inventory">
        <description>A DBMaster plugin that parses native sql server logs to get aggregated login statistics</description>

        <parameters>
            <parameter name="p_servers"   title="Servers"   type="string" required="false" multiple="true"
                       suggestion="project_connections" width="300" />
            <parameter name="p_resolve_hosts" title="Resolve hosts" type="boolean" required="true" defaultValue="false" /> 
            <parameter name="p_tracking_file"        title="Path to Excel file"   type="string" required="true" />
            <parameter name="p_email"                title="Email"   type="string" required="false" />
            <parameter name="p_backup"               title="Backup"   type="boolean" required="true" defaultValue="false" />
        </parameters>

        <output  script="sqlserver-login-audit-tracking.groovy" type="html" />
    </tool>
    
    <tool id="db-principal-info" title="SQL Principal Info" projectTypes="inventory">
        <description>Displays information about sql server principal</description>

        <parameters>
            <parameter name="p_server"   title="Database Server"   type="string" required="false" multiple="false"
                       suggestion="project_connections" width="300" />

            <parameter name="p_principal" title="SQL User or group"    type="string" required="true" width="400" /> 
            <parameter name="p_ldap_connection" title="LDAP Connection" type="string" required="true" suggestion="project_connections" width="300" />
            <parameter name="p_ldap_context" title="LDAP Base Context"  type="string" required="true"  width="400" />
        </parameters>

        <output  script="principal-info.groovy" type="html" />
    </tool>
</tools>
